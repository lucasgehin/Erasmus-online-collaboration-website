// Generated by CoffeeScript 1.6.3
(function() {
  var sanitize, socket;

  socket = io.connect("/home");

  socket.on('connect', function() {
    console.log("IO: Connected!");
    return socket.on("message", function(data) {
      return console.log("Message from server: " + data);
    });
  });

  socket.on('connecting', function() {
    return console.log("IO: Connecting to /home...");
  });

  sanitize = function(event, jqueryObject) {
    event.preventDefault();
    event.stopPropagation();
    if (jqueryObject.is(":animated")) {
      jqueryObject.stop();
      return jqueryObject.clearQueue();
    }
  };

  this.User_Manager = function($scope) {
    var traiter_donnees;
    $scope.list = [];
    $scope.get_users = function() {
      return socket.emit('get_users_list', null, function(response) {
        var u, _i, _len, _ref;
        $scope.list = response;
        _ref = $scope.list;
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          u = _ref[_i];
          traiter_donnees(u, function() {
            return $scope.$apply();
          });
        }
        return console.log("User list saved");
      });
    };
    traiter_donnees = function(user, cb) {
      if (!user.picture) {
        return socket.emit("random_pokemon", null, function(img) {
          console.log(img);
          user.picture = img;
          return cb();
        });
      }
    };
    return $(document).ready(function() {
      return $scope.get_users();
    });
  };

  this.News_Management = function($scope) {
    $scope.list = [];
    $scope.get_news_list = function() {
      console.log("Getting news list");
      return socket.emit('get_news_list', null, function(response) {
        $scope.list = response;
        console.log("New List : ");
        console.log(response);
        if ($scope.list.length === 0) {
          $scope.list.push({
            id: -1,
            title: "There is nothing here :(",
            content: "Add a message",
            date: ''
          });
        }
        return $scope.$apply();
      });
    };
    return $(document).ready(function() {
      return $scope.get_news_list();
    });
  };

}).call(this);
